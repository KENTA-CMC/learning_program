{
  "name": "streamlit-lab",
  "image": "mcr.microsoft.com/devcontainers/python:3.12",

  // ❶ uv を公式コミュニティ Feature で追加（軽量・1行で済む）
  "features": {
    "ghcr.io/jsburckhardt/devcontainer-features/uv:1": {}
  },

  // ❷ venv を作り、そこで uv install
  "postCreateCommand": [
    // venv 作成（.venv はリポジトリ直下に置く）
    "uv venv .venv",

    // venv をアクティベートして依存をインストール
    ". .venv/bin/activate && uv pip install -r .devcontainer/requirements.txt",

    // ❸ 以後ログイン時に自動アクティベート（便利オプション）
    "echo 'source $(pwd)/.venv/bin/activate' >> ~/.bashrc"
  ],

  // ❹ すべてのシェルに .venv/bin を確実に通す
  "remoteEnv": {
    "PATH": "${workspaceFolder}/.venv/bin:/usr/local/bin:/usr/bin:/bin"
  },

  "forwardPorts": [8501],

  "customizations": {
    "vscode": {
      "extensions": ["ms-python.python", "ms-python.vscode-pylance"]
    }
  }
}
